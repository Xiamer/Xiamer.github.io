<!DOCTYPE html>












  


<html class="theme-next pisces use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
























<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=7.1.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.1.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.1.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.1.0">


  <link rel="mask-icon" href="/images/logo.svg?v=7.1.0" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '7.1.0',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="Xiamer blog">
<meta property="og:type" content="website">
<meta property="og:title" content="Xiamer">
<meta property="og:url" content="http://blog.xiamer.top/index.html">
<meta property="og:site_name" content="Xiamer">
<meta property="og:description" content="Xiamer blog">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Xiamer">
<meta name="twitter:description" content="Xiamer blog">





  
  
  <link rel="canonical" href="http://blog.xiamer.top/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>Xiamer</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Xiamer</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <p class="site-subtitle">Xiamer blog</p>
      
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home menu-item-active">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档</a>

  </li>

      
      
    </ul>
  

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://blog.xiamer.top/2019/07/12/chrome-应用开发基本配置/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Xiamer">
      <meta itemprop="description" content="Xiamer blog">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xiamer">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/07/12/chrome-应用开发基本配置/" class="post-title-link" itemprop="url">chrome 应用开发基本配置</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-07-12 16:22:59" itemprop="dateCreated datePublished" datetime="2019-07-12T16:22:59+08:00">2019-07-12</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-07-22 01:48:12" itemprop="dateModified" datetime="2019-07-22T01:48:12+08:00">2019-07-22</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/web前端/" itemprop="url" rel="index"><span itemprop="name">web前端</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="chrome应用简介"><a href="#chrome应用简介" class="headerlink" title="chrome应用简介"></a>chrome应用简介</h2><h3 id="什么是chome应用？"><a href="#什么是chome应用？" class="headerlink" title="什么是chome应用？"></a>什么是chome应用？</h3><p>Chrome 应用提供了与原生应用能力相同的体验，但是与网页一样安全。就像网上应用一样，Chrome 应用使用 HTML5、JavaScript 和 CSS 编写，但是 Chrome 应用从外观上与行为上都与原生应用类似，它们也具有类似于原生应用的能力，比网上应用可用的更强大。</p>
<h3 id="chrome-应用下载"><a href="#chrome-应用下载" class="headerlink" title="chrome 应用下载"></a>chrome 应用下载</h3><p>打开<code>chrome</code>浏览器后，点击<br><img src="/images/chrome-extension/1.jpeg" alt="chrome商店"><br>后，再点击应用商店进入<a href="https://chrome.google.com/webstore/category/extensions" target="_blank" rel="noopener">chrome 网上应用店</a>，就可以下载自己喜欢的应用了。</p>
<h3 id="常用的chrome-应用"><a href="#常用的chrome-应用" class="headerlink" title="常用的chrome 应用"></a>常用的chrome 应用</h3><ul>
<li><a href="https://chrome.google.com/webstore/detail/adblock-plus-free-ad-bloc/cfhdojbkjhnklbpkdaibdccddilifddb?utm_source=chrome-ntp-icon" target="_blank" rel="noopener">Adblock Plus 拦截广告</a> </li>
<li><a href="https://chrome.google.com/webstore/detail/postman-interceptor/aicmkgpgakddgnaphhhpliifpcfhicfo?utm_source=chrome-ntp-icon" target="_blank" rel="noopener">Postman Interceptor</a></li>
<li><a href="https://chrome.google.com/webstore/detail/web%E5%89%8D%E7%AB%AF%E5%8A%A9%E6%89%8Bfehelper/pkgccpejnmalmdinmhkkfafefagiiiad?utm_source=chrome-ntp-icon" target="_blank" rel="noopener">web 前端助手</a></li>
<li><a href="https://chrome.google.com/webstore/detail/%E5%88%92%E8%AF%8D%E7%BF%BB%E8%AF%91/ikhdkkncnoglghljlkmcimlnlhkeamad?utm_source=chrome-ntp-**icon**" target="_blank" rel="noopener">划词翻译</a><br><img src="/images/chrome-extension/2.jpeg" alt="fehelper"></li>
</ul>
<h2 id="开发与调试"><a href="#开发与调试" class="headerlink" title="开发与调试"></a>开发与调试</h2><p>直接输入 <a href="chrome://extensions/" target="_blank" rel="noopener">chrome://extensions/</a>，开启开发者模式<br><img src="/images/chrome-extension/3.jpg" alt="开发者模式">，右键选择你要调试的应用点击<br><img src="/images/chrome-extension/4.jpg" alt="审查元素"> 后面的程序就和普通页面调试一模一样了。</p>
<h2 id="核心文件-manifest-json"><a href="#核心文件-manifest-json" class="headerlink" title="核心文件 manifest.json"></a>核心文件 manifest.json</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">// 必须的字段</span><br><span class="line">  // 应用名称</span><br><span class="line">  "name": "My Extension",</span><br><span class="line">  // 应用版本</span><br><span class="line">  "version": "1.0.0",</span><br><span class="line">  // manifest_version</span><br><span class="line">  "manifest_version": 2,</span><br><span class="line"></span><br><span class="line">// 建议提供的字段</span><br><span class="line">  // 应用描述</span><br><span class="line">  "description": "A plain text description",</span><br><span class="line">  // 图标</span><br><span class="line">  "icons": &#123; </span><br><span class="line">    "16": "icon16.png",             </span><br><span class="line">    "48": "icon48.png",            </span><br><span class="line">    "128": "icon128.png" </span><br><span class="line">   &#125;,</span><br><span class="line">   // 语言</span><br><span class="line">  "default_locale": "en",</span><br><span class="line">  </span><br><span class="line">  // 浏览器右上角图标设置，browser_action、page_action、app三选一或者都不选</span><br><span class="line">  "browser_action": &#123;</span><br><span class="line">    "default_icon": &#123;                    // optional</span><br><span class="line">      "16": "images/icon16.png",           // optional</span><br><span class="line">      "24": "images/icon24.png",           // optional</span><br><span class="line">      "32": "images/icon32.png"            // optional</span><br><span class="line">    &#125;,</span><br><span class="line">    "default_title": "Google Mail",      // optional; shown in tooltip</span><br><span class="line">    "default_popup": "popup.html"        // optional</span><br><span class="line">  &#125;,</span><br><span class="line">  // 当某些特定页面打开才显示的图标</span><br><span class="line">  "page_action": &#123;</span><br><span class="line">    "default_icon": "icons/foo.png", // optional </span><br><span class="line">    "default_title": "Do action",    // optional; shown in tooltip </span><br><span class="line">    "default_popup": "popup.html"    // optional </span><br><span class="line">  &#125;,</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">// 根据需要提供</span><br><span class="line">  // 从启动浏览器开始，整个生命周期都存在</span><br><span class="line">  // 一般仅仅需要js文件,浏览器的扩展系统会自动根据上面scripts字段指定的所有js文件自动生成背景页，也可指定背景页。</span><br><span class="line">  "background": &#123;</span><br><span class="line">    "scripts": ["background.js"],</span><br><span class="line">    "persistent": false</span><br><span class="line">    // "page": "background.html"</span><br><span class="line">  &#125;,</span><br><span class="line">  // 可以将Chrome默认的一些特定页面替换掉 (书签管理器chrome://bookmarks 、历史记录 chrome://history、空白标签页chrome://newtab)</span><br><span class="line">  "chrome_url_overrides": &#123;</span><br><span class="line">    "newtab": "myPage.html"</span><br><span class="line">  &#125;,</span><br><span class="line">  // 嵌入到页面内运行的javascript脚本,只可访问页面的dom和修改。</span><br><span class="line">  "content_scripts": [</span><br><span class="line">    &#123;</span><br><span class="line">       // "&lt;all_urls&gt;" 表示匹配所有地址</span><br><span class="line">      "matches": ["http://*/*", "https://*/*"],</span><br><span class="line">      // "matches": ["&lt;all_urls&gt;"],</span><br><span class="line">      "css": ["mystyles.css"],</span><br><span class="line">      "js": ["jquery.js", "myscript.js"],</span><br><span class="line">      "run_at": "document_start",  // document_start || document_end || document_idle 默认（document_end和发出window.onload事件之间的某个时机注入）</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  // 安全策略</span><br><span class="line">  "content_security_policy": "policyString",</span><br><span class="line">  // 上传（需要加权限 permissions: fileBrowserHandler）</span><br><span class="line">  "file_browser_handlers": [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"id"</span>: <span class="string">"upload"</span>,</span><br><span class="line">      "default_title": "保存至照片库", // 按钮上显示的文字</span><br><span class="line">      "file_filters": [</span><br><span class="line">        "filesystem:*.jpg", // 要匹配所有文件，请使用 "filesystem:*.*"</span><br><span class="line">        "filesystem:*.jpeg",</span><br><span class="line">        <span class="string">"filesystem:*.png"</span></span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  // devtools页面入口，只能是html</span><br><span class="line">    "devtools_page": "devtools.html",</span><br><span class="line">  // 扩展的主页 url</span><br><span class="line">  "homepage_url": "http://path/to/homepage",</span><br><span class="line">  // 可选值："spanning"和"split"，指定当扩展在允许隐身模式下运行时如何响应。</span><br><span class="line">  "incognito": "spanning" or "split",</span><br><span class="line">  // 开发时为扩展指定的唯一标识值(不需要设置)</span><br><span class="line">  "key": "publicKey",</span><br><span class="line">  // 最低版本</span><br><span class="line">  "minimum_chrome_version": "versionString",</span><br><span class="line">  // 指定本扩展或app是否支持脱机运行。</span><br><span class="line">  "offline_enabled": true,</span><br><span class="line">  // 关键词搜索匹配</span><br><span class="line">  "omnibox": &#123; "keyword": "aaron" &#125;,</span><br><span class="line">  // 选项页</span><br><span class="line">  "options_page": "aFile.html",</span><br><span class="line">  // 权限</span><br><span class="line">  "permissions": [</span><br><span class="line">    "tabs", // 标签</span><br><span class="line">    "bookmarks", // 书签</span><br><span class="line">    "http://www.blogger.com/",</span><br><span class="line">    "http://*.google.com/",</span><br><span class="line">    "contextMenus", // 右键菜单</span><br><span class="line">    "notifications", // 通知</span><br><span class="line">    "webRequest", // web请求</span><br><span class="line">    "cookies",</span><br><span class="line">    "background",</span><br><span class="line">    "history",</span><br><span class="line">    "storage", // 插件本地存储</span><br><span class="line">    "http://*/*", // 可以通过executeScript或者insertCSS访问的网站</span><br><span class="line">    "https://*/*" // 可以通过executeScript或者insertCSS访问的网站</span><br><span class="line">  ],</span><br><span class="line">  // 自动升级url</span><br><span class="line">  "update_url": "http://path/to/updateInfo.xml",</span><br><span class="line">  // 指定本扩展在注入的目标页面上所需使用的资源的路径</span><br><span class="line">  "web_accessible_resources": [</span><br><span class="line">    "images/my-awesome-image1.png",</span><br><span class="line">    "images/my-amazing-icon1.png",</span><br><span class="line">    "style/double-rainbow.css",</span><br><span class="line">    <span class="string">"script/double-rainbow.js"</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="各js权限"><a href="#各js权限" class="headerlink" title="各js权限"></a>各js权限</h2><table>
<thead>
<tr>
<th style="text-align:left">类型</th>
<th style="text-align:left">可访问的api</th>
<th>是否可访问DOM</th>
<th style="text-align:left">是否可访问JS</th>
<th style="text-align:left">是否可跨域</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">content_script</td>
<td style="text-align:left">只能访问 extension、runtime等部分API</td>
<td>Y</td>
<td style="text-align:left">N</td>
<td style="text-align:left">N</td>
</tr>
<tr>
<td style="text-align:left">popup.js</td>
<td style="text-align:left">可访问绝大部分API，除了devtools系列</td>
<td>N</td>
<td style="text-align:left">N</td>
<td style="text-align:left">Y</td>
</tr>
<tr>
<td style="text-align:left">background.js</td>
<td style="text-align:left">可访问绝大部分API，除了devtools系列</td>
<td>N</td>
<td style="text-align:left">N</td>
<td style="text-align:left">Y</td>
</tr>
<tr>
<td style="text-align:left">devtools.js</td>
<td style="text-align:left">只能访问 devtools、extension、runtime等部分AP</td>
<td>Y</td>
<td style="text-align:left">Y</td>
<td style="text-align:left">N</td>
</tr>
</tbody>
</table>
<h2 id="通信能力"><a href="#通信能力" class="headerlink" title="通信能力"></a>通信能力</h2><table>
<thead>
<tr>
<th style="text-align:left"></th>
<th style="text-align:left">injected-script</th>
<th>content-script</th>
<th style="text-align:left">popup-js</th>
<th style="text-align:left">background-js</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">injected-script</td>
<td style="text-align:left">-</td>
<td>window.postMessage</td>
<td style="text-align:left">-</td>
<td style="text-align:left">-</td>
</tr>
<tr>
<td style="text-align:left">content-script</td>
<td style="text-align:left">window.postMessage</td>
<td>-</td>
<td style="text-align:left">chrome.runtime.sendMessage  chrome.runtime.connect</td>
<td style="text-align:left">chrome.runtime.sendMessage  chrome.runtime.connect</td>
</tr>
<tr>
<td style="text-align:left">popup-js</td>
<td style="text-align:left">-</td>
<td>chrome.tabs.sendMessage chrome.tabs.connect</td>
<td style="text-align:left">-</td>
<td style="text-align:left">chrome.extension. getBackgroundPage()</td>
</tr>
<tr>
<td style="text-align:left">background-js</td>
<td style="text-align:left">-</td>
<td>chrome.tabs.sendMessage chrome.tabs.connect</td>
<td style="text-align:left">chrome.extension.getViews</td>
<td style="text-align:left">-</td>
</tr>
<tr>
<td style="text-align:left">devtools-js</td>
<td style="text-align:left">chrome.devtools. inspectedWindow.eval</td>
<td>-</td>
<td style="text-align:left">chrome.runtime.sendMessage</td>
<td style="text-align:left">chrome.runtime.sendMessage</td>
</tr>
</tbody>
</table>
<h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><ul>
<li><a href="https://developer.chrome.com/extensions" target="_blank" rel="noopener">chrome 应用开发官网</a></li>
<li><a href="http://open.chrome.360.cn/extension_dev/permissions.html" target="_blank" rel="noopener">360浏览器 应用开发官网</a></li>
<li><a href="https://www.cnblogs.com/liuxianan/p/chrome-plugin-develop.html" target="_blank" rel="noopener">【干货】Chrome插件(扩展)开发全攻略</a></li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://blog.xiamer.top/2019/06/26/stylus入门/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Xiamer">
      <meta itemprop="description" content="Xiamer blog">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xiamer">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/06/26/stylus入门/" class="post-title-link" itemprop="url">stylus入门</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-06-26 17:36:16" itemprop="dateCreated datePublished" datetime="2019-06-26T17:36:16+08:00">2019-06-26</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-07-04 03:46:39" itemprop="dateModified" datetime="2019-07-04T03:46:39+08:00">2019-07-04</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/web前端/" itemprop="url" rel="index"><span itemprop="name">web前端</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>本文只是简单介绍<code>stylus</code>的基本用法，了解更多建议去<a href="http://stylus-lang.com/" target="_blank" rel="noopener">官网</a>查看。<br>在线编辑 <a href="http://stylus-lang.com/try.html" target="_blank" rel="noopener">stylus2css</a></p>
<h2 id="stylus定义"><a href="#stylus定义" class="headerlink" title="stylus定义"></a>stylus定义</h2><p><strong>富于表现力</strong>、<strong>动态的</strong>、<strong>健壮的</strong> CSS<br>Stylus是一种创新的样式表语言，可编译为CSS。<br>受SASS的启发，Stylus使用node.js构建，并且能够在浏览器中运行，如此交互式教程所示。</p>
<h2 id="Stylus的特征"><a href="#Stylus的特征" class="headerlink" title="Stylus的特征"></a>Stylus的特征</h2><ul>
<li>冒号可选</li>
<li>分号可选</li>
<li>逗号可选</li>
<li>括号可选</li>
<li>变量</li>
<li>插值</li>
<li>混合书写</li>
<li>算术</li>
<li>强制类型转换</li>
<li>动态导入</li>
<li>条件</li>
<li>迭代</li>
<li>嵌套选择</li>
<li>父级参考</li>
<li>变量函数调用</li>
<li>词法作用域</li>
<li>内置函数(&gt;25)</li>
<li>内部语言函数</li>
<li>压缩可选</li>
<li>图像内联可选</li>
<li>可执行Stylus</li>
<li>健壮的错误报告</li>
<li>单行和多行注释</li>
<li>CSS字面量</li>
<li>字符转义</li>
<li>TextMate捆绑</li>
<li>以及其他更多</li>
</ul>
<h2 id="Stylus的使用"><a href="#Stylus的使用" class="headerlink" title="Stylus的使用"></a>Stylus的使用</h2><h3 id="选择器-Selectors"><a href="#选择器-Selectors" class="headerlink" title="选择器(Selectors)"></a>选择器(Selectors)</h3><h4 id="简写"><a href="#简写" class="headerlink" title="简写"></a>简写</h4><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">body</span><br><span class="line">  <span class="attribute">color</span> white</span><br><span class="line">  </span><br><span class="line"><span class="comment">// 编译为</span></span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>stylus</code>有严格的缩进，两个空格符。与平时的写法简介了很多，<code>{}</code> <code>:</code> <code>;</code> 都是可选，方便阅读可加上<code>:</code>。</p>
<h4 id="规则集"><a href="#规则集" class="headerlink" title="规则集"></a>规则集</h4><p>Stylus允许使用多个逗号或换行选择器同时定义属性。<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 以下两种写法是等价的</span></span><br><span class="line"><span class="selector-tag">div</span>, p</span><br><span class="line">  <span class="attribute">color</span> <span class="number">#fff</span></span><br><span class="line"></span><br><span class="line">div</span><br><span class="line">p</span><br><span class="line">  <span class="attribute">color</span> <span class="number">#fff</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 编译为</span></span><br><span class="line"><span class="selector-tag">div</span>,</span><br><span class="line"><span class="selector-tag">p</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>当我们需要同时给 a中的b中的 x 和 c中的d中的x 添加属性 可写成<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">foo bar baz,</span><br><span class="line"><span class="selector-tag">form</span> <span class="selector-tag">input</span>,</span><br><span class="line">&gt; a</span><br><span class="line">  <span class="attribute">border</span> <span class="number">1px</span> solid</span><br><span class="line">  </span><br><span class="line"><span class="comment">// 编译为</span></span><br><span class="line">foo bar baz,</span><br><span class="line"><span class="selector-tag">form</span> <span class="selector-tag">input</span>,</span><br><span class="line">&gt; <span class="selector-tag">a</span> &#123;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="父级引用-amp"><a href="#父级引用-amp" class="headerlink" title="父级引用 &amp;"></a>父级引用 &amp;</h4><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">textarea</span><br><span class="line">input</span><br><span class="line">  <span class="attribute">color</span> <span class="number">#A7A7A7</span></span><br><span class="line">  &amp;:hover</span><br><span class="line">    <span class="attribute">color</span> <span class="number">#000</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 编译为</span></span><br><span class="line"><span class="selector-tag">textarea</span>,</span><br><span class="line"><span class="selector-tag">input</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#a7a7a7</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">textarea</span>:hover,</span><br><span class="line"><span class="selector-tag">input</span>:hover &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#000</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h2><p>可以直接指定表达式变量</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$font</span>-size = <span class="number">14px</span></span><br><span class="line"><span class="variable">$font</span> = <span class="variable">$font</span>-size <span class="string">"Lucida Grande"</span>, Arial</span><br><span class="line"></span><br><span class="line">body</span><br><span class="line">  <span class="attribute">font</span> <span class="variable">$font</span> sans-serif</span><br><span class="line">  </span><br><span class="line"><span class="comment">// 编译为</span></span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">font</span>: <span class="number">14px</span> <span class="string">"Lucida Grande"</span>, Arial sans-serif;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>为了区分变量和原有属性，建议变量以<code>$</code>开头</p>
<h2 id="属性查找"><a href="#属性查找" class="headerlink" title="属性查找"></a>属性查找</h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">#logo</span><br><span class="line">  <span class="attribute">position</span>: absolute</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">50%</span></span><br><span class="line">  <span class="attribute">left</span>: <span class="number">50%</span></span><br><span class="line">  <span class="attribute">width</span>: <span class="number">150px</span></span><br><span class="line">  <span class="attribute">height</span>: <span class="number">80px</span></span><br><span class="line">  <span class="attribute">margin-left</span>: -(@width / <span class="number">2</span>)</span><br><span class="line">  <span class="attribute">margin-top</span>: -(@height / <span class="number">2</span>)</span><br><span class="line">  </span><br><span class="line"><span class="comment">// 编译为</span></span><br><span class="line"><span class="selector-id">#logo</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">150px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">80px</span>;</span><br><span class="line">  <span class="attribute">margin-left</span>: -<span class="number">75px</span>;</span><br><span class="line">  <span class="attribute">margin-top</span>: -<span class="number">40px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>使用<code>@</code>+<code>属性名</code> 来访问该属性名对应的值</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">body</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#f00</span></span><br><span class="line">  ul</span><br><span class="line">    li</span><br><span class="line">      <span class="attribute">color</span>: <span class="number">#00f</span></span><br><span class="line">      a</span><br><span class="line">        <span class="attribute">background-color</span>: @color</span><br><span class="line">        </span><br><span class="line"><span class="comment">// 编译为</span></span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#f00</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">body</span> <span class="selector-tag">ul</span> <span class="selector-tag">li</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#00f</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">body</span> <span class="selector-tag">ul</span> <span class="selector-tag">li</span> <span class="selector-tag">a</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#00f</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>属性会向上冒泡，找到最近属性名对应的属性值</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">position</span><span class="params">()</span></span></span><br><span class="line">  <span class="attribute">position</span>: arguments</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">1</span> unless @z-index // 指定默认值为<span class="number">1</span></span><br><span class="line"></span><br><span class="line">#logo</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">20</span></span><br><span class="line">  <span class="attribute">position</span>: absolute</span><br><span class="line"></span><br><span class="line">#logo2</span><br><span class="line">  <span class="attribute">position</span>: absolute</span><br><span class="line">  </span><br><span class="line"><span class="comment">// 编译为</span></span><br><span class="line"><span class="selector-id">#logo</span> &#123;</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">20</span>;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#logo2</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>z-index</code> 和 <code>position</code> 先后顺序无关，只与当前选择器所选择的全部属性有关</p>
<h2 id="插值"><a href="#插值" class="headerlink" title="插值"></a>插值</h2><p>Stylus支持通过使用{}字符包围表达式来插入值，会变成标识符的一部分。例如，-webkit-{‘border’ + ‘-radius’}等同于-webkit-border-radius.<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">vendor</span><span class="params">(prop, args)</span></span></span><br><span class="line">  -webkit-&#123;prop&#125; args</span><br><span class="line">  -moz-&#123;prop&#125; args</span><br><span class="line">  &#123;prop&#125; args</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">border-radius</span><span class="params">()</span></span></span><br><span class="line">  vendor(<span class="string">'border-radius'</span>, arguments)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">button</span><br><span class="line">  <span class="attribute">border-radius</span> <span class="number">1px</span> <span class="number">2px</span> / <span class="number">3px</span> <span class="number">4px</span></span><br><span class="line">  </span><br><span class="line"><span class="comment">// 编译为</span></span><br><span class="line"><span class="selector-tag">button</span> &#123;</span><br><span class="line">  -webkit-<span class="attribute">border-radius</span>: <span class="number">1px</span> <span class="number">2px</span> / <span class="number">3px</span> <span class="number">4px</span>;</span><br><span class="line">  -moz-<span class="attribute">border-radius</span>: <span class="number">1px</span> <span class="number">2px</span> / <span class="number">3px</span> <span class="number">4px</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">1px</span> <span class="number">2px</span> / <span class="number">3px</span> <span class="number">4px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>可以看做 <code>border-radius</code> 混合写入（后面会讲），然后再调用<code>vendor</code></p>
<h2 id="运算符-Operators"><a href="#运算符-Operators" class="headerlink" title="运算符(Operators)"></a>运算符(Operators)</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[]</span><br><span class="line">! ~ + -</span><br><span class="line">is defined</span><br><span class="line">** * / %</span><br><span class="line">+ -</span><br><span class="line">... ..</span><br><span class="line">&lt;= &gt;= &lt; &gt;</span><br><span class="line">in</span><br><span class="line">== is != is not isnt</span><br><span class="line">is a</span><br><span class="line">&amp;&amp; and || or</span><br><span class="line">?:</span><br><span class="line">= := ?= += -= *= /= %=</span><br><span class="line">not</span><br><span class="line">if unless</span><br></pre></td></tr></table></figure>
<p>上表运算符优先级，从最高到最低.</p>
<h3 id="一级运算符"><a href="#一级运算符" class="headerlink" title="一级运算符"></a>一级运算符</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">!<span class="number">0</span></span><br><span class="line"><span class="comment">// =&gt; true</span></span><br><span class="line"></span><br><span class="line">!!<span class="number">0</span></span><br><span class="line"><span class="comment">// =&gt; false</span></span><br><span class="line"></span><br><span class="line">!<span class="number">1</span></span><br><span class="line"><span class="comment">// =&gt; false</span></span><br></pre></td></tr></table></figure>
<h3 id="铸造"><a href="#铸造" class="headerlink" title="铸造"></a>铸造</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">body</span><br><span class="line">  n = <span class="number">5</span></span><br><span class="line">  foo: (n)em</span><br><span class="line">  foo: (n)%</span><br><span class="line">  foo: (n + 5)%</span><br><span class="line">  foo: (n * 5)px</span><br><span class="line">  foo: unit(n + <span class="number">5</span>, <span class="string">'%'</span>)</span><br><span class="line">  foo: unit(<span class="number">5</span> + <span class="number">180</span> / <span class="number">2</span>, deg)</span><br></pre></td></tr></table></figure>
<p>unit()函数可用来强制后缀</p>
<h2 id="混合书写-Mixins"><a href="#混合书写-Mixins" class="headerlink" title="混合书写(Mixins)"></a>混合书写(Mixins)</h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">border-radius</span><span class="params">(n)</span></span></span><br><span class="line">  -webkit-<span class="attribute">border-radius</span> n</span><br><span class="line">  -moz-<span class="attribute">border-radius</span> n</span><br><span class="line">  <span class="attribute">border-radius</span> n</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">form</span> <span class="selector-tag">input</span>[type=button]</span><br><span class="line">  <span class="attribute">border-radius</span> <span class="number">5px</span></span><br><span class="line">  </span><br><span class="line"><span class="comment">// 编译为</span></span><br><span class="line"><span class="selector-tag">form</span> <span class="selector-tag">input</span>[type=button] &#123;</span><br><span class="line">  -webkit-<span class="attribute">border-radius</span>: <span class="number">5px</span>;</span><br><span class="line">  -moz-<span class="attribute">border-radius</span>: <span class="number">5px</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">5px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>border-radius</code> 使用了混合 调用了<code>border-radius</code> 也可不指定参数，利用局部变量 <code>arguments</code>代替</p>
<h2 id="方法-Functions"><a href="#方法-Functions" class="headerlink" title="方法(Functions)"></a>方法(Functions)</h2><h3 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h3><p>Stylus强大之处就在于其内置的语言函数定义。其定义与混入(mixins)一致；却可以返回值。</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">add</span><span class="params">(a, b)</span></span></span><br><span class="line">  <span class="selector-tag">a</span> + b</span><br><span class="line"><span class="selector-tag">body</span> </span><br><span class="line">  <span class="attribute">padding</span> add(<span class="number">10px</span>, <span class="number">5</span>)</span><br><span class="line">  </span><br><span class="line"><span class="comment">// 编译为</span></span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">15px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="默认值"><a href="#默认值" class="headerlink" title="默认值"></a>默认值</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">add</span><span class="params">(a, b = <span class="number">5</span>)</span></span></span><br><span class="line">  <span class="selector-tag">a</span> + b</span><br><span class="line"><span class="selector-tag">body</span> </span><br><span class="line">  <span class="attribute">padding</span> add(<span class="number">10px</span>)</span><br><span class="line">  </span><br><span class="line"><span class="comment">// 编译为</span></span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">15px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="多个返回值-可看做数组"><a href="#多个返回值-可看做数组" class="headerlink" title="多个返回值(可看做数组)"></a>多个返回值(可看做数组)</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">sizes = <span class="number">15px</span> <span class="number">10px</span></span><br><span class="line"></span><br><span class="line">sizes[<span class="number">0</span>]</span><br><span class="line"><span class="comment">// =&gt; 15px</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">sizes</span><span class="params">()</span></span></span><br><span class="line"> <span class="number">15px</span> <span class="number">10px</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">sizes</span><span class="params">()</span></span>[<span class="number">0</span>]</span><br><span class="line"><span class="comment">// =&gt; 15px</span></span><br></pre></td></tr></table></figure>
<h3 id="变量函数"><a href="#变量函数" class="headerlink" title="变量函数"></a>变量函数</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">invoke(a, b, fn)</span><br><span class="line">  fn(a, b)</span><br><span class="line"></span><br><span class="line">add(a, b)</span><br><span class="line">  a + b</span><br><span class="line"></span><br><span class="line">body</span><br><span class="line">  padding invoke(5, 10, add)</span><br><span class="line">  padding invoke(5, 10, sub)</span><br><span class="line">  </span><br><span class="line">// 编译为</span><br><span class="line">body &#123;</span><br><span class="line">  padding: 15;</span><br><span class="line">  padding: -5;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://blog.xiamer.top/2019/06/15/hook/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Xiamer">
      <meta itemprop="description" content="Xiamer blog">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xiamer">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/06/15/hook/" class="post-title-link" itemprop="url">hook</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-06-15 16:29:58" itemprop="dateCreated datePublished" datetime="2019-06-15T16:29:58+08:00">2019-06-15</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-07-04 03:55:52" itemprop="dateModified" datetime="2019-07-04T03:55:52+08:00">2019-07-04</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/web前端/" itemprop="url" rel="index"><span itemprop="name">web前端</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>本文主要介绍下<code>React Hook</code> 和 <code>Vue Function-based API RFC</code>，通过一些简单案列进行对比。</p>
<h2 id="React-Hook"><a href="#React-Hook" class="headerlink" title="React Hook"></a>React Hook</h2><h3 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h3><ol>
<li>组件状态复用性逻辑困难（render props 、 HOC）</li>
<li>无状态Function组件</li>
<li>class中的this指向</li>
</ol>
<h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><p>在不编写 class 的情况下使用 state 以及其他的 React 特性。<br>主要解决的问题是状态共享，是继 <code>render-props</code> 和 <code>HOC</code> 之后的第三种状态共享方案，不会产生 <code>JSX</code> 嵌套地狱问题。</p>
<h3 id="useState"><a href="#useState" class="headerlink" title="useState"></a>useState</h3><p><code>useState</code>可以让函数组件也具备类组件的state功能</p>
<p>先来看一个简单计数的例子，Component写法<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Example</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line"> <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">   <span class="keyword">super</span>(props);</span><br><span class="line">   <span class="keyword">this</span>.state = &#123;</span><br><span class="line">     count: <span class="number">0</span></span><br><span class="line">   &#125;;</span><br><span class="line"> &#125;</span><br><span class="line"> render() &#123;</span><br><span class="line">   <span class="keyword">return</span> (</span><br><span class="line">     &lt;div&gt;</span><br><span class="line">       &lt;p&gt;You clicked &#123;<span class="keyword">this</span>.state.count&#125; times&lt;<span class="regexp">/p&gt;</span></span><br><span class="line"><span class="regexp">       &lt;button onClick=&#123;() =&gt; this.setState(&#123; count: this.state.count + 1 &#125;)&#125;&gt;</span></span><br><span class="line"><span class="regexp">         Click me</span></span><br><span class="line"><span class="regexp">       &lt;/</span>button&gt;</span><br><span class="line">     &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">   );</span></span><br><span class="line"><span class="regexp"> &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure></p>
<p>useState写法<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; useState &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Example</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"> <span class="keyword">const</span> [count, setCount] = useState(<span class="number">0</span>);</span><br><span class="line"> <span class="keyword">return</span> (</span><br><span class="line">   &lt;div&gt;</span><br><span class="line">     &lt;p&gt;You clicked &#123;count&#125; times&lt;<span class="regexp">/p&gt;</span></span><br><span class="line"><span class="regexp">     &lt;button onClick=&#123;() =&gt; setCount(count + 1)&#125;&gt;Click me&lt;/</span>button&gt;</span><br><span class="line">   &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp"> );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure></p>
<p>调用了react的useState钩子函数，用数组结构赋值 <code>count</code> <code>setConut</code>代替了 <code>this.state.conut</code> <code>this.setState({count: xx})</code>。</p>
<p>多个state是怎么定义呢？<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ExampleWithManyStates</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"> <span class="keyword">const</span> [age, setAge] = useState(<span class="number">42</span>);</span><br><span class="line"> <span class="keyword">const</span> [fruit, setFruit] = useState(<span class="string">'banana'</span>);</span><br><span class="line"> <span class="keyword">const</span> [todos, setTodos] = useState([&#123; <span class="attr">text</span>: <span class="string">'Learn Hooks'</span> &#125;]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>执行过程又是怎样的？<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//第一次渲染</span></span><br><span class="line">useState(<span class="number">42</span>);  <span class="comment">//将age初始化为42</span></span><br><span class="line">useState(<span class="string">'banana'</span>);  <span class="comment">//将fruit初始化为banana</span></span><br><span class="line">useState([&#123; <span class="attr">text</span>: <span class="string">'Learn Hooks'</span> &#125;]); <span class="comment">//...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//第二次渲染</span></span><br><span class="line">useState(<span class="number">42</span>);  <span class="comment">//读取状态变量age的值（这时候传的参数42直接被忽略）</span></span><br><span class="line">useState(<span class="string">'banana'</span>);  <span class="comment">//读取状态变量fruit的值（这时候传的参数banana直接被忽略）</span></span><br><span class="line">useState([&#123; <span class="attr">text</span>: <span class="string">'Learn Hooks'</span> &#125;]); <span class="comment">//...</span></span><br></pre></td></tr></table></figure></p>
<p>useState的使用</p>
<ol>
<li>声明state const [count, setCount] = useState(0); （参数、返回值）</li>
<li>读取state count</li>
<li>更新state setCount(count + 1)</li>
<li>多个state 多次调用useState</li>
<li>声明顺序来确保useState 相互独立，底层链表实现。</li>
</ol>
<h3 id="Effect"><a href="#Effect" class="headerlink" title="Effect"></a>Effect</h3><p>定义: 你之前可能已经在 React 组件中执行过数据获取、订阅或者手动修改过 DOM。我们统一把这些操作称为“副作用”，或者简称为“作用”。<br>可看做： componentDidMount，componentDidUpdate 和 componentWillUnmount的集合。</p>
<p>来看一个移动鼠标在页面显示坐标的例子</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">MyClassApp</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line"> <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">   <span class="keyword">super</span>(props);</span><br><span class="line">   <span class="keyword">this</span>.state = &#123;</span><br><span class="line">     x: <span class="number">0</span>,</span><br><span class="line">     y: <span class="number">0</span></span><br><span class="line">   &#125;;</span><br><span class="line">   <span class="keyword">this</span>.handleUpdate = <span class="keyword">this</span>.handleUpdate.bind(<span class="keyword">this</span>);</span><br><span class="line"> &#125;</span><br><span class="line"> componentDidMount() &#123;</span><br><span class="line">   <span class="built_in">document</span>.addEventListener(<span class="string">'mousemove'</span>, <span class="keyword">this</span>.handleUpdate);</span><br><span class="line"> &#125;</span><br><span class="line"> componentDidUpdate() &#123;</span><br><span class="line">   <span class="keyword">const</span> &#123; x, y &#125; = <span class="keyword">this</span>.state;</span><br><span class="line">   <span class="built_in">document</span>.title = <span class="string">`(<span class="subst">$&#123;x&#125;</span>,<span class="subst">$&#123;y&#125;</span>)`</span>;</span><br><span class="line"> &#125;</span><br><span class="line"> componentWillUnmount() &#123;</span><br><span class="line">   <span class="built_in">window</span>.removeEventListener(<span class="string">'mousemove'</span>,<span class="keyword">this</span>.handleUpdate);</span><br><span class="line"> &#125;</span><br><span class="line"> </span><br><span class="line">handleUpdate(e) &#123;</span><br><span class="line">   <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">     x: e.clientX,</span><br><span class="line">     y: e.clientY</span><br><span class="line">   &#125;);</span><br><span class="line"> &#125;</span><br><span class="line"> render() &#123;</span><br><span class="line">   <span class="keyword">return</span> (</span><br><span class="line">     &lt;div&gt;</span><br><span class="line">       current position x:&#123;<span class="keyword">this</span>.state.x&#125;, <span class="attr">y</span>:&#123;<span class="keyword">this</span>.state.y&#125;</span><br><span class="line">     &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">   );</span></span><br><span class="line"><span class="regexp"> &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<p>useEffect 自定义hook高级写法：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; useState, useEffect &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 自定义hook useMousePostion</span></span><br><span class="line"><span class="keyword">const</span> useMousePostion = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line"> <span class="comment">// 使用hookuseState初始化一个state</span></span><br><span class="line">  <span class="keyword">const</span> [postion, setPostion]=useState(&#123; <span class="attr">x</span>: <span class="number">0</span>, <span class="attr">y</span>: <span class="number">0</span> &#125;);</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">handleMove</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">    setPostion(&#123; <span class="attr">x</span>: e.clientX, <span class="attr">y</span>: e.clientY &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"> <span class="comment">// 使用useEffect处理class中生命周期可以做到的事情</span></span><br><span class="line">  useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line"> <span class="comment">// 同时可以处理 componentDidMount 以及 componentDidUpdate 中的事情</span></span><br><span class="line">   <span class="built_in">window</span>.addEventListener(<span class="string">'mousemove'</span>, handleMove);</span><br><span class="line">   <span class="built_in">document</span>.title = <span class="string">`(<span class="subst">$&#123;postion.x&#125;</span>,<span class="subst">$&#123;postion.y&#125;</span>)`</span>;</span><br><span class="line">   <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">     <span class="comment">// return的function 可以相当于在组件被卸载的时候执行 类似于 componentWillUnmount</span></span><br><span class="line">     <span class="built_in">window</span>.removeEventListener(<span class="string">'mousemove'</span>, handleMove);</span><br><span class="line">   &#125;;</span><br><span class="line">   <span class="comment">// [] 是参数，代表deps，也就是说react触发这个hook的时机会和传入的deps有关，内部利用object.is实现</span></span><br><span class="line">   <span class="comment">// 默认不给参数会在每次render的时候调用，给空数组会导致每次比较是一样的，只执行一次。</span></span><br><span class="line"> &#125;, [postion]);</span><br><span class="line"> <span class="comment">// postion 可以被直接return，这样达到了逻辑的复用~，哪里需要哪里调用就可以了。</span></span><br><span class="line"> <span class="keyword">return</span> postion;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"> <span class="keyword">const</span> &#123; x, y &#125; = useMousePostion(); <span class="comment">// 内部维护自己的postion相关的逻辑</span></span><br><span class="line"> <span class="keyword">return</span> (</span><br><span class="line">   &lt;div&gt;</span><br><span class="line">     current position x: &#123;x&#125;, <span class="attr">y</span>: &#123;y&#125;</span><br><span class="line">   &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp"> );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure></p>
<h3 id="useContext"><a href="#useContext" class="headerlink" title="useContext"></a>useContext</h3><p>数据传递<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; Provider, Consumer &#125; = React.createContext(<span class="literal">null</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Bar</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"> <span class="keyword">return</span> &lt;Consumer&gt;&#123;color =&gt; &lt;div&gt;&#123;color&#125;&lt;/div&gt;&#125;&lt;/Consumer&gt;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"> <span class="keyword">return</span> &lt;Bar /&gt;;</span><br><span class="line">&#125;</span><br><span class="line">function App() &#123;</span><br><span class="line"> return (</span><br><span class="line">   &lt;Provider value=&#123;"grey"&#125;&gt;</span><br><span class="line">     &lt;Foo /&gt;</span><br><span class="line">   &lt;/Provider&gt;</span><br><span class="line"> );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>用useContext hook 写法：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; useState, useContext &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">const</span> colorContext = React.createContext(<span class="string">"gray"</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Bar</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"> <span class="keyword">const</span> color = useContext(colorContext);</span><br><span class="line"> <span class="keyword">return</span> &lt;div&gt;&#123;color&#125;&lt;/div&gt;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"> <span class="keyword">return</span> &lt;Bar /&gt;;</span><br><span class="line">&#125;</span><br><span class="line">function App() &#123;</span><br><span class="line"> return (</span><br><span class="line">   &lt;colorContext.Provider value=&#123;"red"&#125;&gt;</span><br><span class="line">     &lt;Foo /&gt;</span><br><span class="line">   &lt;/colorContext.Provider&gt;</span><br><span class="line"> );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>传递给 useContext 的是 context 而不是 consumer，返回值即是想要透传的数据了，减少了组件层级。</p>
<h3 id="useReducer"><a href="#useReducer" class="headerlink" title="useReducer"></a>useReducer</h3><p><code>useState</code> 实现登陆：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; useState, useReducer &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">LoginPage</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"> <span class="keyword">const</span> [name, setName] = useState(<span class="string">''</span>); <span class="comment">// 用户名</span></span><br><span class="line"> <span class="keyword">const</span> [pwd, setPwd] = useState(<span class="string">''</span>); <span class="comment">// 密码</span></span><br><span class="line"> <span class="keyword">const</span> [isLoading, setIsLoading] = useState(<span class="literal">false</span>); <span class="comment">// 是否展示loading，发送请求中</span></span><br><span class="line"> <span class="keyword">const</span> [error, setError] = useState(<span class="string">''</span>); <span class="comment">// 错误信息</span></span><br><span class="line"> <span class="keyword">const</span> [isLoggedIn, setIsLoggedIn] = useState(<span class="literal">false</span>); <span class="comment">// 是否登录</span></span><br><span class="line"></span><br><span class="line"> <span class="keyword">const</span> login = <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">   event.preventDefault();</span><br><span class="line">   setError(<span class="string">''</span>);</span><br><span class="line">   setIsLoading(<span class="literal">true</span>);</span><br><span class="line">   login(&#123; name, pwd &#125;)</span><br><span class="line">     .then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">       setIsLoggedIn(<span class="literal">true</span>);</span><br><span class="line">       setIsLoading(<span class="literal">false</span>);</span><br><span class="line">     &#125;)</span><br><span class="line">     .catch(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">       <span class="comment">// 登录失败: 显示错误信息、清空输入框用户名、密码、清除loading标识</span></span><br><span class="line">       setError(error.message);</span><br><span class="line">       setName(<span class="string">''</span>);</span><br><span class="line">       setPwd(<span class="string">''</span>);</span><br><span class="line">       setIsLoading(<span class="literal">false</span>);</span><br><span class="line">     &#125;);</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">return</span> (</span><br><span class="line">     <span class="comment">//  返回页面JSX Element</span></span><br><span class="line"> )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><code>useReducer</code> 实现登陆</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> initState = &#123;</span><br><span class="line">    name: <span class="string">''</span>,</span><br><span class="line">    pwd: <span class="string">''</span>,</span><br><span class="line">    isLoading: <span class="literal">false</span>,</span><br><span class="line">    error: <span class="string">''</span>,</span><br><span class="line">    isLoggedIn: <span class="literal">false</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">loginReducer</span>(<span class="params">state, action</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">switch</span>(action.type) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'login'</span>:</span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                ...state,</span><br><span class="line">                isLoading: <span class="literal">true</span>,</span><br><span class="line">                error: <span class="string">''</span>,</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'success'</span>:</span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                ...state,</span><br><span class="line">                isLoggedIn: <span class="literal">true</span>,</span><br><span class="line">                isLoading: <span class="literal">false</span>,</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'error'</span>:</span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                ...state,</span><br><span class="line">                error: action.payload.error,</span><br><span class="line">                name: <span class="string">''</span>,</span><br><span class="line">                pwd: <span class="string">''</span>,</span><br><span class="line">                isLoading: <span class="literal">false</span>,</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="keyword">default</span>: </span><br><span class="line">            <span class="keyword">return</span> state;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">LoginPage</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> [state, dispatch] = useReducer(loginReducer, initState);</span><br><span class="line">    <span class="keyword">const</span> &#123; name, pwd, isLoading, error, isLoggedIn &#125; = state;</span><br><span class="line">    <span class="keyword">const</span> login = <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">        event.preventDefault();</span><br><span class="line">        dispatch(&#123; <span class="attr">type</span>: <span class="string">'login'</span> &#125;);</span><br><span class="line">        login(&#123; name, pwd &#125;)</span><br><span class="line">            .then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">                dispatch(&#123; <span class="attr">type</span>: <span class="string">'success'</span> &#125;);</span><br><span class="line">            &#125;)</span><br><span class="line">            .catch(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">                dispatch(&#123;</span><br><span class="line">                    type: <span class="string">'error'</span></span><br><span class="line">                    payload: &#123; <span class="attr">error</span>: error.message &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ( </span><br><span class="line">        <span class="comment">//  返回页面JSX Element</span></span><br><span class="line">    )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>虽然用<code>useReducer</code>写法代码比较长，但是可读性会变好很多。把<strong>做什么</strong>和<strong>怎么做</strong>分开，组件中只需要考虑<strong>做什么</strong>，<strong>怎么做</strong>逻辑全部都抽到<code>Reducer</code>中。</p>
<h3 id="React-other-hook"><a href="#React-other-hook" class="headerlink" title="React other hook"></a>React other hook</h3><ul>
<li>useClassback 记忆函数</li>
<li>useMemo 记忆组件</li>
<li>useRef 保存引用值</li>
<li>useImperativeHandle 透传 Ref</li>
<li>useLayoutEffect 同步执行副作用</li>
</ul>
<p>具体详情建议去官网链接 <a href="https://react.docschina.org/docs/hooks-intro.html" target="_blank" rel="noopener">React Hook</a></p>
<h3 id="Hook-使用规则"><a href="#Hook-使用规则" class="headerlink" title="Hook 使用规则"></a>Hook 使用规则</h3><ul>
<li>只能在函数最顶层调用 Hook。不要在循环、条件判断或者子函数中调用。</li>
<li>只能在 React 的函数组件中调用 Hook。不要在其他 JavaScript 函数中调用。（除了自定义Hook）</li>
</ul>
<h2 id="Vue-（Function-base-on-RFC）"><a href="#Vue-（Function-base-on-RFC）" class="headerlink" title="Vue （Function base on RFC）"></a>Vue （Function base on RFC）</h2><h3 id="常见问题-1"><a href="#常见问题-1" class="headerlink" title="常见问题"></a>常见问题</h3><ul>
<li>mixins (多个逻辑变得复杂，命名冲突)</li>
<li>HOC （props）</li>
<li>slot 多层嵌套</li>
</ul>
<h3 id="value"><a href="#value" class="headerlink" title="value"></a>value</h3><p>我们来直接看一个例子</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; value &#125;  <span class="keyword">from</span> Vue;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">useMouse</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"> <span class="keyword">const</span> x = value(<span class="number">0</span>)</span><br><span class="line"> <span class="keyword">const</span> y = value(<span class="number">0</span>)</span><br><span class="line"> <span class="keyword">const</span> update = <span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">   x.value = e.pageX</span><br><span class="line">   y.value = e.pageY</span><br><span class="line"> &#125;</span><br><span class="line"> onMounted(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">   <span class="built_in">window</span>.addEventListener(<span class="string">'mousemove'</span>, update)</span><br><span class="line"> &#125;)</span><br><span class="line"> onUnmounted(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">   <span class="built_in">window</span>.removeEventListener(<span class="string">'mousemove'</span>, update)</span><br><span class="line"> &#125;)</span><br><span class="line"> <span class="keyword">return</span> &#123; x, y &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 在组件中使用该函数</span></span><br><span class="line"><span class="keyword">const</span> Component = &#123;</span><br><span class="line"> setup() &#123;</span><br><span class="line">   <span class="keyword">const</span> &#123; x, y &#125; = useMouse()</span><br><span class="line">   <span class="comment">// 与其它函数配合使用</span></span><br><span class="line">   <span class="keyword">const</span> &#123; z &#125; = useOtherLogic()</span><br><span class="line">   <span class="keyword">return</span> &#123; x, y, z &#125;</span><br><span class="line"> &#125;,</span><br><span class="line"> template: <span class="string">`&lt;div&gt;&#123;&#123; x &#125;&#125; &#123;&#123; y &#125;&#125; &#123;&#123; z &#125;&#125;&lt;/div&gt;`</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>把逻辑抽到一个函数中，组件引用时使用数据来源清晰,参数重命名。<br>value()</p>
<ul>
<li>返回是一个包装对象 value wrapper ()</li>
<li>只有一个属性 value</li>
</ul>
<p><strong>为什么需要包装对象？</strong></p>
<p>我们知道在 JavaScript 中，原始值类型如 string 和 number 是只有值，没有引用的。如果在一个函数中返回一个字符串变量，接收到这个字符串的代码只会获得一个值，是无法追踪原始变量后续的变化的。</p>
<p>用法</p>
<ul>
<li>声明 let msg = value(‘look’)</li>
<li>读取 msg.value</li>
<li>修改 msg.value = ‘here’</li>
<li>模板 unwrap </li>
</ul>
<h3 id="Computed"><a href="#Computed" class="headerlink" title="Computed"></a>Computed</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; value, computed &#125; <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> count = value(<span class="number">0</span>)</span><br><span class="line"><span class="keyword">const</span> countPlusOne = computed(<span class="function"><span class="params">()</span> =&gt;</span> count.value + <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(countPlusOne.value) <span class="comment">// 1</span></span><br><span class="line"></span><br><span class="line">count.value++</span><br><span class="line"><span class="built_in">console</span>.log(countPlusOne.value) <span class="comment">// 2</span></span><br><span class="line"><span class="keyword">const</span> count = value(<span class="number">0</span>)</span><br><span class="line"><span class="keyword">const</span> writableComputed = computed(</span><br><span class="line"> <span class="comment">// read</span></span><br><span class="line"> () =&gt; count.value + <span class="number">1</span>,</span><br><span class="line"> <span class="comment">// write</span></span><br><span class="line"> val =&gt; &#123;</span><br><span class="line">   count.value = val - <span class="number">1</span></span><br><span class="line"> &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>computed() 返回的是一个只读的包装对象，它可以和普通的包装对象一样在 setup() 中被返回 ，也一样会在渲染上下文中被自动展开。默认情况下，如果用户试图去修改一个只读包装对象，会触发警告。双向计算值可以通过传给 computed 第二个参数作为 setter 来创建。</p>
<h3 id="Watchers"><a href="#Watchers" class="headerlink" title="Watchers"></a>Watchers</h3><p>watch() API 提供了基于观察状态的变化来执行副作用的能力。<br>参数</p>
<ol>
<li>数据源 （返回任意值的函数、包装对象、数组）</li>
<li>Callback</li>
<li><p>watchOption</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> WatchOptions &#123;</span><br><span class="line"> lazy?: <span class="built_in">boolean</span></span><br><span class="line"> deep?: <span class="built_in">boolean</span></span><br><span class="line"> flush?: <span class="string">'pre'</span> | <span class="string">'post'</span> | <span class="string">'sync'</span></span><br><span class="line"> onTrack?: <span class="function">(<span class="params">e: DebuggerEvent</span>) =&gt;</span> <span class="built_in">void</span></span><br><span class="line"> onTrigger?: <span class="function">(<span class="params">e: DebuggerEvent</span>) =&gt;</span> <span class="built_in">void</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>创建时会执行一次 和 v2.x immediate: true类似</p>
</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> MyComponent = &#123;</span><br><span class="line"> props: &#123;</span><br><span class="line">   id: <span class="built_in">Number</span></span><br><span class="line"> &#125;,</span><br><span class="line"> setup(props) &#123;</span><br><span class="line">   <span class="keyword">const</span> data = value(<span class="literal">null</span>)</span><br><span class="line">   watch(<span class="function"><span class="params">()</span> =&gt;</span> props.id, <span class="keyword">async</span> (id) =&gt; &#123;</span><br><span class="line">     data.value = <span class="keyword">await</span> fetchData(id)</span><br><span class="line">   &#125;)</span><br><span class="line">   <span class="keyword">return</span> &#123;</span><br><span class="line">     data</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>初始化时和接收到的id发生变化时 执行watch</p>
<p>Watchers 清理副作用<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">watch(idValue, (id, oldId, onCleanup) =&gt; &#123;</span><br><span class="line"> <span class="keyword">const</span> token = performAsyncOperation(id)</span><br><span class="line"> onCleanup(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">   <span class="comment">// id 发生了变化，或是 watcher 即将被停止. （分页）</span></span><br><span class="line">   <span class="comment">// 取消还未完成的异步操作。</span></span><br><span class="line">   token.cancel()</span><br><span class="line"> &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<h3 id="声明周期函数"><a href="#声明周期函数" class="headerlink" title="声明周期函数"></a>声明周期函数</h3><p>所有现有的生命周期钩子都会有对应的 onXXX 函数（只能在 setup() 中使用）：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; onMounted, onUpdated, onUnmounted &#125; <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> MyComponent = &#123;</span><br><span class="line"> setup() &#123;</span><br><span class="line">   onMounted(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">     <span class="built_in">console</span>.log(<span class="string">'mounted!'</span>)</span><br><span class="line">   &#125;)</span><br><span class="line">   onUpdated(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">     <span class="built_in">console</span>.log(<span class="string">'updated!'</span>)</span><br><span class="line">   &#125;)</span><br><span class="line">   <span class="comment">// destroyed 调整为 unmounted</span></span><br><span class="line">   onUnmounted(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">     <span class="built_in">console</span>.log(<span class="string">'unmounted!'</span>)</span><br><span class="line">   &#125;)</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="same-point"><a href="#same-point" class="headerlink" title="same point"></a>same point</h2><ul>
<li>解决问题是一样  逻辑复用过乱，代码体积体积过大 ，this问题（Function很少和this打交道）。</li>
<li>使用方式类似 复用一些单独的逻辑抽离到函数，返回组件所用的数据，内部维护数据更新，从而触发视图更新。</li>
</ul>
<h2 id="diff-point"><a href="#diff-point" class="headerlink" title="diff point"></a>diff point</h2><ul>
<li>react（链表）每一个hook的next指向下一个hook</li>
<li>vue hook 只会在setup调用时执行一次</li>
<li>react 数据更改时导致render执行，会重新注册hook，需要借助useCallBack、uesMomo等处理</li>
</ul>
<h3 id="尤大大总结"><a href="#尤大大总结" class="headerlink" title="尤大大总结"></a>尤大大总结</h3><ul>
<li>整体更符合js的直觉</li>
<li>不受调用顺序的限制，可有条件地调用</li>
<li>会在后续更新时不断产生大量的内联函数而影响引擎优化或是导致 GC 压力；</li>
<li>不需要总是使用 useCallback 来缓存传给子组件的回调以防止过度更新；</li>
<li>不需要担心传了错误的依赖数组给 useEffect/useMemo/useCallback 从而导致回调中使用了过期的值 —— Vue 的依赖追踪是全自动的。</li>
</ul>
<h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><ul>
<li><a href="https://react.docschina.org/docs/hooks-intro.html" target="_blank" rel="noopener">React Hook</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/68477600" target="_blank" rel="noopener">Vue Function-based API RFC</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/50597236" target="_blank" rel="noopener">一篇看懂 React Hooks</a></li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://blog.xiamer.top/2019/05/19/js中-proto-和prototype的关系/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Xiamer">
      <meta itemprop="description" content="Xiamer blog">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xiamer">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/05/19/js中-proto-和prototype的关系/" class="post-title-link" itemprop="url">js中__proto__和prototype的关系</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-05-19 12:13:48" itemprop="dateCreated datePublished" datetime="2019-05-19T12:13:48+08:00">2019-05-19</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-07-04 02:15:58" itemprop="dateModified" datetime="2019-07-04T02:15:58+08:00">2019-07-04</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/web前端/" itemprop="url" rel="index"><span itemprop="name">web前端</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>本文内容主要来自<a href="https://www.zhihu.com/question/34183746" target="_blank" rel="noopener">js中<strong>proto</strong>和prototype的区别和关系？</a>作者<a href="https://www.zhihu.com/people/doris-53-22/activities" target="_blank" rel="noopener">doris</a>的回答，主要用于以后知识点回顾。</p>
<h2 id="对象的隐式对象-proto-指向构造函数的原型对象-proptotype"><a href="#对象的隐式对象-proto-指向构造函数的原型对象-proptotype" class="headerlink" title="对象的隐式对象(proto)指向构造函数的原型对象(proptotype)"></a>对象的隐式对象(<em>proto</em>)指向构造函数的原型对象(proptotype)</h2><p>   在JS里，万物皆对象。方法（Function）是对象，方法的原型(Function.prototype)是对象。因此，它们都会具有对象共有的特点。即：对象具有属性<strong>proto</strong>，可称为隐式原型，一个对象的隐式原型指向构造该对象的构造函数的原型，这也保证了实例能够访问在构造函数原型中定义的属性和方法。</p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">function Persion()&#123; this.name = &apos;mingming&apos; &#125;;</span><br><span class="line">Persion.prototype.say = function() &#123;return &apos;say&apos;&#125;;</span><br><span class="line">Persion.prototype.name = &apos;prohonghong&apos;;</span><br><span class="line">let p1 = new Persion();</span><br><span class="line">p1.__proto__ === Persion.prototype; // true</span><br><span class="line">Persion.__proto__ === Function.prototype;  // true</span><br><span class="line">Persion.prototype.__proto__ === Object.prototype; // true</span><br><span class="line">Object.prototype.__proto__; // null</span><br><span class="line">p1.say(); // say</span><br><span class="line">p1.name; // mingming</span><br><span class="line">p1.__proto__.name; // prohonghong</span><br></pre></td></tr></table></figure>
<h2 id="Function原型对象-prototype-的构造器-constructor-指回原构造函数"><a href="#Function原型对象-prototype-的构造器-constructor-指回原构造函数" class="headerlink" title="Function原型对象(prototype)的构造器(constructor)指回原构造函数"></a>Function原型对象(prototype)的构造器(constructor)指回原构造函数</h2><p> 方法这个特殊的对象，除了和其他对象一样有上述<em>proto</em>属性之外，还有自己特有的属性——原型属性（prototype），这个属性是一个指针，指向一个对象，这个对象的用途就是包含所有实例共享的属性和方法（我们把这个对象叫做原型对象）。原型对象也有一个属性，叫做constructor，这个属性包含了一个指针，指回原构造函数。</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Persion.prototype.constructor === Persion // true</span><br><span class="line">Persion.constructor === Function // true</span><br><span class="line">Function.prototype.constructor === Function // true</span><br></pre></td></tr></table></figure>
<h2 id="原型链关系图"><a href="#原型链关系图" class="headerlink" title="原型链关系图"></a>原型链关系图</h2><p><img src="/images/prototype.jpg" alt></p>
<ol>
<li><p>构造函数Foo()</p>
<p>构造函数的原型属性Foo.prototype指向了原型对象，在原型对象里有共有的方法，所有构造函数声明的实例（这里是f1，f2）都可以共享这个方法。</p>
</li>
<li><p>原型对象Foo.prototype</p>
<p>Foo.prototype保存着实例共享的方法，有一个指针constructor指回构造函数。</p>
</li>
<li><p>实例</p>
<p>f1和f2是Foo这个对象的两个实例，这两个对象也有属性<strong>proto</strong>，指向构造函数的原型对象，这样子就可以像上面1所说的访问原型对象的所有方法啦。</p>
</li>
</ol>
<p>  另外：构造函数Foo()除了是方法，也是对象啊，它也有<strong>proto</strong>属性，指向它的构造函数的原型对象。<br>  函数的构造函数是Function，因此这里的<strong>proto</strong>指向了Function.prototype。其实除了Foo()，Function(), Object()也是一样的道理。<br>  原型对象也是对象啊，它的<strong>proto</strong>属性，又指向谁呢？同理，指向它的构造函数的原型对象呗。这里是Object.prototype.最后，Object.prototype的<strong>proto</strong>属性指向null。</p>
<h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><ul>
<li><a href="https://www.zhihu.com/question/34183746" target="_blank" rel="noopener">https://www.zhihu.com/question/34183746</a></li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://blog.xiamer.top/2019/05/09/Event-deep/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Xiamer">
      <meta itemprop="description" content="Xiamer blog">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xiamer">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/05/09/Event-deep/" class="post-title-link" itemprop="url">JS Event deep</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-05-09 17:54:15" itemprop="dateCreated datePublished" datetime="2019-05-09T17:54:15+08:00">2019-05-09</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-07-04 02:15:34" itemprop="dateModified" datetime="2019-07-04T02:15:34+08:00">2019-07-04</time>
              
            
          </span>

          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="进程和线程"><a href="#进程和线程" class="headerlink" title="进程和线程"></a>进程和线程</h2><p>进程(Process)是系统资源分配和调度的单元。一个运行着的程序就对应了一个进程。一个进程包括了运行中的程序和程序所使用到的内存和系统资源。如果是单核CPU的话，在同一时间内，有且只有一个进程在运行。但是，单核CPU也能实现多任务同时运行，比如你边听网易云音乐的每日推荐歌曲，边在网易有道云笔记上写博文。这算开了两个进程（多进程），那运行的机制就是一会儿播放一下歌，一会儿响应一下你的打字，但由于CPU切换的速度很快，你根本感觉不到，以至于你认为这两个进程是在同时运行的。进程之间是资源隔离的。</p>
<p>那线程(Thread)是什么？线程是进程下的执行者，一个进程至少会开启一个线程（主线程），也可以开启多个线程。比如网易云音乐一边播放音频，一边显示歌词。多进程的运行其实也就是通过进程中的线程来执行的。一个进程下的线程是共享资源的。当多个线程同时操作同一个资源的时候，就出现资源争抢的问题。这又是另外一个问题了。</p>
<p>操作系统的设计，可以归结为三点：</p>
<ol>
<li><p>以多进程形式，允许多个任务同时运行；</p>
</li>
<li><p>以多线程形式，允许单个任务分成不同的部分运行；</p>
</li>
<li><p>提供协调机制，一方面防止进程之间和线程之间产生冲突，另一方面允许进程之间和线程之间共享资源。</p>
</li>
</ol>
<h2 id="Javascript是单线程"><a href="#Javascript是单线程" class="headerlink" title="Javascript是单线程"></a>Javascript是单线程</h2><p>其实这与它的用途有关。作为浏览器脚本语言，JavaScript 的主要用途是与用户互动，以及操作 DOM。若以多线程的方式操作这些 DOM，则可能出现操作的冲突。假设有两个线程同时操作一个 DOM 元素，线程1 要求浏览器删除 DOM，而线程2 却要求修改 DOM 样式，这时浏览器就无法决定采用哪个线程的操作。当然，我们可以为浏览器引入“锁”的机制来解决这些冲突，但这会大大提高复杂性，所以 JavaScript 从诞生开始就选择了单线程执行。</p>
<p>另外，因为 JavaScript 是单线程的，在某一时刻内只能执行特定的一个任务，并且会阻塞其它任务执行。那么对于类似 I/O 等耗时的任务，就没必要等待他们执行完后才继续后面的操作。在这些任务完成前，JavaScript 完全可以往下执行其他操作，当这些耗时的任务完成后则以回调的方式执行相应处理。这些就是 JavaScript 与生俱来的特性：异步与回调。</p>
<h2 id="浏览器不是单线程的"><a href="#浏览器不是单线程的" class="headerlink" title="浏览器不是单线程的"></a>浏览器不是单线程的</h2><p>虽然JS运行在浏览器中，是单线程的，每个window一个JS线程，但浏览器不是单线程的，例如Webkit或是Gecko引擎，都可能有如下线程：</p>
<ul>
<li>javascript引擎线程</li>
<li>界面渲染线程</li>
<li>浏览器事件触发线程</li>
<li>Http请求线程</li>
</ul>
<h2 id="同步任务和异步任务"><a href="#同步任务和异步任务" class="headerlink" title="同步任务和异步任务"></a>同步任务和异步任务</h2><p>单线程就意味着，所有任务需要排队，前一个任务结束，才会执行后一个任务。如果前一个任务耗时很长，后一个任务就不得不一直等着。</p>
<p>JavaScript语言的设计者意识到，这时主线程完全可以不管IO设备，挂起处于等待中的任务，先运行排在后面的任务。等到IO设备返回了结果，再回过头，把挂起的任务继续执行下去。</p>
<p>于是，所有任务可以分成两种，一种是<strong>同步任务</strong>（synchronous），另一种是<strong>异步任务</strong>（asynchronous）。同步任务指的是，在主线程上排队执行的任务，只有前一个任务执行完毕，才能执行后一个任务；异步任务指的是，不进入主线程、而进入”任务队列”（task queue）的任务，只有”任务队列”通知主线程，某个异步任务可以执行了，该任务才会进入主线程执行。</p>
<p><img src="images/event-deep/1.webp" alt></p>
<p>具体来说，异步执行的运行机制如下。（同步执行也是如此，因为它可以被视为没有异步任务的异步执行。）</p>
<ol>
<li><p>所有同步任务都在主线程上执行，形成一个<strong>执行栈</strong>（execution context stack）。</p>
</li>
<li><p>主线程之外，还存在一个”任务队列”（task queue）。只要异步任务有了运行结果，就在”任务队列”之中放置一个事件。</p>
</li>
<li><p>一旦”执行栈”中的所有同步任务执行完毕，系统就会读取”任务队列”，看看里面有哪些事件。那些对应的异步任务，于是结束等待状态，进入执行栈，开始执行。</p>
</li>
<li><p>主线程不断重复上面的第三步。</p>
</li>
</ol>
<h2 id="宏任务队列和微任务队列"><a href="#宏任务队列和微任务队列" class="headerlink" title="宏任务队列和微任务队列"></a>宏任务队列和微任务队列</h2><p>任务队列：<strong>宏任务队列</strong>（macro tasks）和<strong>微任务队列</strong>（micro tasks）。宏任务队列可以有多个，微任务队列只有一个。</p>
<ul>
<li>宏任务：宿主(浏览器/node)发起的任务，主要有script（全局任务）, setTimeout, setInterval, setImmediate, I/O, UI rendering.</li>
<li>微任务：js引擎发起的任务，主要有process.nextTick, Promise, Object.observer(已废弃), MutationObserver.</li>
</ul>
<blockquote>
<p><strong>一段代码块就是一个宏任务。</strong>所以一般执行代码块的时候，也就是程序执行进入主线程了，主线程会根据不同的代码再分微任务和宏任务等待主线程执行完成后，不停地循环执行。<br>主线程（宏任务） =&gt; 微任务 =&gt; 宏任务 =&gt; 主线程</p>
</blockquote>
<p><img src="images/event-deep/2.webp" alt></p>
<p><strong>主要部分</strong>：  开始-&gt; 取task queue(macro task)第一个task执行(script) -&gt; 取micro task全部任务依次执行 -&gt; 取task queue下一个任务执行 -&gt; 再次取出micro task全部任务执行 -&gt; … 另外在处理microtask期间，如果有新添加的microtasks，也会被添加到队列的末尾并执行。js引擎存在<strong>monitoring process进程</strong>， 会不停的监听<code>task queue</code></p>
<p>细节可以参考 <a href="https://github.com/creeperyang/blog/issues/21" target="_blank" rel="noopener">Tasks和Microtasks</a></p>
<p>列子1：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">console.log(&apos;script start&apos;);</span><br><span class="line"></span><br><span class="line">// 微任务</span><br><span class="line">Promise.resolve().then(() =&gt; &#123;</span><br><span class="line">    console.log(&apos;p 1&apos;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// 宏任务</span><br><span class="line">setTimeout(() =&gt; &#123;</span><br><span class="line">    console.log(&apos;setTimeout&apos;);</span><br><span class="line">&#125;, 0);</span><br><span class="line"></span><br><span class="line">var s = new Date();</span><br><span class="line">while(new Date() - s &lt; 50); // 阻塞50ms</span><br><span class="line"></span><br><span class="line">// 微任务</span><br><span class="line">Promise.resolve().then(() =&gt; &#123;</span><br><span class="line">    console.log(&apos;p 2&apos;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">console.log(&apos;script ent&apos;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">/*** output ***/</span><br><span class="line"></span><br><span class="line">// one macro task</span><br><span class="line">script start</span><br><span class="line">script ent</span><br><span class="line"></span><br><span class="line">// all micro tasks</span><br><span class="line">p 1</span><br><span class="line">p 2</span><br><span class="line"></span><br><span class="line">// one macro task again</span><br><span class="line">setTimeout</span><br></pre></td></tr></table></figure></p>
<p>上面之所以加50ms的阻塞，是因为 <code>setTimeout</code> 的 delayTime 最少是 4ms. 为了避免认为 <code>setTimeout</code> 是因为4ms的延迟而后面才被执行的，我们加了50ms阻塞。</p>
<p>例子2:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">async function async1()&#123;</span><br><span class="line">    console.log(&apos;async1 start&apos;)</span><br><span class="line">    await async2()</span><br><span class="line">    console.log(&apos;async1 end&apos;)</span><br><span class="line">&#125;</span><br><span class="line">async function async2()&#123;</span><br><span class="line">    console.log(&apos;async2&apos;)</span><br><span class="line">&#125;</span><br><span class="line">console.log(&apos;script start&apos;)</span><br><span class="line">setTimeout(function()&#123;</span><br><span class="line">    console.log(&apos;setTimeout&apos;) </span><br><span class="line">&#125;,0)  </span><br><span class="line">async1();</span><br><span class="line">new Promise(function(resolve)&#123;</span><br><span class="line">    console.log(&apos;promise1&apos;)</span><br><span class="line">    resolve();</span><br><span class="line">&#125;).then(function()&#123;</span><br><span class="line">    console.log(&apos;promise2&apos;)</span><br><span class="line">&#125;)</span><br><span class="line">console.log(&apos;script end&apos;)</span><br></pre></td></tr></table></figure>
<ul>
<li>定义函数async1、async2。输出’script start’</li>
<li>将 setTimeout 里面的回调函数(宏任务)添加到<strong>下一轮任务队列</strong>。因为这段代码前面没有执行任何的异步操作且等待时间为0s。所以回调函数会被立刻放到下一轮任务队列的开头。</li>
<li>执行async1。我们知道async函数里面await标记之前的语句和 await 后面的语句是同步执行的。所以这里先后输出”async1 start”,’async2 start‘. (根据 TC39 最近决议，await将直接使用 Promise.resolve() 相同语义。)</li>
<li>这时暂停执行下面的语句，下面的语句被放到当前队列的最后。<br>继续执行同步任务。</li>
<li>输出 ‘Promise1’。将then里面的函数放在当前队列的最后。</li>
<li>然后输出‘script end’,注意这时只是同步任务执行完了，当前任务队列的任务还没有执行完毕，还有两个微任务被添加进来了!队列是先进先出的结构，所以这里先输出 ‘async1 end’ 再输出 ‘Promise2’,这时第一轮任务队列才真算执行完了。</li>
<li>然后执行下一个任务列表的任务。执行setTimeout里面的异步函数。输出‘setTimeout’。</li>
</ul>
<p>作者：sliiva<br>链接：<a href="https://juejin.im/post/5c8a024d51882546be0a3082" target="_blank" rel="noopener">https://juejin.im/post/5c8a024d51882546be0a3082</a><br>来源：掘金<br>著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。</p>
<h2 id="Event-Loop"><a href="#Event-Loop" class="headerlink" title="Event Loop"></a>Event Loop</h2><p>主线程从”任务队列”中读取事件，这个过程是循环不断的，所以整个的这种运行机制又称为Event Loop（事件循环）。</p>
<p><img src="images/event-deep/3.webp" alt></p>
<h2 id="NodeJs-的-Event-Loop"><a href="#NodeJs-的-Event-Loop" class="headerlink" title="NodeJs 的 Event Loop"></a>NodeJs 的 Event Loop</h2><p>Node.js也是单线程的Event Loop，但是它的运行机制不同于浏览器环境。</p>
<p><img src="images/event-deep/4.png" alt></p>
<ol>
<li>V8引擎解析JavaScript脚本。</li>
<li>解析后的代码，调用Node API。</li>
<li>libuv库负责Node API的执行。它将不同的任务分配给不同的线程，形成一个Event Loop（事件循环），以异步的方式将任务的执行结果返回给V8引擎。</li>
<li>V8引擎再将结果返回给用户。</li>
</ol>
<p>除了setTimeout和setInterval这两个方法，Node.js还提供了另外两个与”任务队列”有关的方法: <strong>process.nextTick</strong>和<strong>setImmediate</strong>。process.nextTick方法可以在当前”执行栈”的尾部—-下一次Event Loop（主线程读取”任务队列”）之前—-触发回调函数。也就是说，它指定的任务总是发生在所有异步任务之前。setImmediate方法则是在当前”任务队列”的尾部添加事件，也就是说，它指定的任务总是在下一次Event Loop时执行。</p>
<h3 id="Node-js-Event-Loop原理"><a href="#Node-js-Event-Loop原理" class="headerlink" title="Node.js Event Loop原理"></a>Node.js Event Loop原理</h3><p>node.js的特点是事件驱动，非阻塞单线程。当应用程序需要I/O操作的时候，线程并不会阻塞，而是把I/O操作交给底层库（LIBUV）。此时node线程会去处理其他任务，当底层库处理完I/O操作后，会将主动权交还给Node线程，所以Event Loop的用处是调度线程，例如：当底层库处理I/O操作后调度Node线程处理后续工作，所以虽然node是单线程，但是底层库处理操作依然是多线程</p>
<h3 id="Node-Event-Loop的事件处理机制"><a href="#Node-Event-Loop的事件处理机制" class="headerlink" title="Node Event Loop的事件处理机制"></a>Node Event Loop的事件处理机制</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">   ┌───────────────────────────┐</span><br><span class="line">┌─&gt;│           timers          │</span><br><span class="line">│  └─────────────┬─────────────┘</span><br><span class="line">│  ┌─────────────┴─────────────┐</span><br><span class="line">│  │     pending callbacks     │</span><br><span class="line">│  └─────────────┬─────────────┘</span><br><span class="line">│  ┌─────────────┴─────────────┐</span><br><span class="line">│  │       idle, prepare       │</span><br><span class="line">│  └─────────────┬─────────────┘      ┌───────────────┐</span><br><span class="line">│  ┌─────────────┴─────────────┐      │   incoming:   │</span><br><span class="line">│  │           poll            │&lt;─────┤  connections, │</span><br><span class="line">│  └─────────────┬─────────────┘      │   data, etc.  │</span><br><span class="line">│  ┌─────────────┴─────────────┐      └───────────────┘</span><br><span class="line">│  │           check           │</span><br><span class="line">│  └─────────────┬─────────────┘</span><br><span class="line">│  ┌─────────────┴─────────────┐</span><br><span class="line">└──┤      close callbacks      │</span><br><span class="line">   └───────────────────────────┘</span><br></pre></td></tr></table></figure>
<ul>
<li>timers: 这个阶段执行setTimeout()和setInterval()设定的回调。</li>
<li>pending callbacks: 上一轮循环中有少数的 I/O callback 会被延迟到这一轮的这一阶段执行。</li>
<li>idle, prepare: 仅内部使用。</li>
<li>poll: 执行 I/O callback，在适当的条件下会阻塞在这个阶段</li>
<li>check: 执行setImmediate()设定的回调。</li>
<li>close callbacks: 执行比如socket.on(‘close’, …)的回调。</li>
</ul>
<h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><ul>
<li><a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html" target="_blank" rel="noopener">JavaScript 运行机制详解：再谈Event Loop</a></li>
<li><a href="https://segmentfault.com/a/1190000011198232" target="_blank" rel="noopener">JavaScript 异步、栈、事件循环、任务队列</a></li>
<li><a href="https://tuobaye.com/2017/10/24/%E9%80%9A%E8%BF%87microtasks%E5%92%8Cmacrotasks%E7%9C%8BJavaScript%E5%BC%82%E6%AD%A5%E4%BB%BB%E5%8A%A1%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F/" target="_blank" rel="noopener">通过microtasks和macrotasks看JavaScript异步任务执行顺序</a></li>
<li><a href="https://juejin.im/post/59e85eebf265da430d571f89" target="_blank" rel="noopener">这一次，彻底弄懂 JavaScript 执行机制</a></li>
<li><a href="https://juejin.im/post/5c8a024d51882546be0a3082" target="_blank" rel="noopener">从面试题看 JS 事件循环与 macro micro 任务队列</a></li>
<li><a href="https://www.jianshu.com/p/12b9f73c5a4f" target="_blank" rel="noopener">深入核心，详解事件循环机制</a></li>
<li><a href="https://juejin.im/post/5b35cdfa51882574c020d685" target="_blank" rel="noopener">node基础面试事件环？微任务、宏任务？</a></li>
<li><a href="https://nodejs.org/en/docs/guides/event-loop-timers-and-nexttick/" target="_blank" rel="noopener">The Node.js Event Loop</a></li>
<li><a href="https://www.cnblogs.com/onepixel/articles/7605465.html" target="_blank" rel="noopener">详解 setTimeout、setImmediate、process.nextTick 的区别</a></li>
<li><a href="https://repl.it/repls/NauticalVastFont" target="_blank" rel="noopener">node.js在线</a></li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://blog.xiamer.top/2018/04/28/gird/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Xiamer">
      <meta itemprop="description" content="Xiamer blog">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xiamer">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/04/28/gird/" class="post-title-link" itemprop="url">css 20分钟玩转 grid</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-04-28 15:37:34" itemprop="dateCreated datePublished" datetime="2018-04-28T15:37:34+08:00">2018-04-28</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-07-04 02:15:40" itemprop="dateModified" datetime="2019-07-04T02:15:40+08:00">2019-07-04</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/web前端/" itemprop="url" rel="index"><span itemprop="name">web前端</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p> CSS网格布局擅长于将一个页面划分为几个主要区域，以及定义这些区域的大小、位置、层次等关系。<br><img src="/images/grid/grid_1.webp" alt="网页基本布局"></p>
<p>学习grid布局之前，请先了解 <a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/flex" target="_blank" rel="noopener">flex</a> 布局，有一定相似性，但这个更强大一些。</p>
<h2 id="属性"><a href="#属性" class="headerlink" title="属性"></a>属性</h2><h3 id="display-设置网格布局"><a href="#display-设置网格布局" class="headerlink" title="display 设置网格布局"></a><code>display</code> 设置网格布局</h3><p><img src="/images/grid/grid_2.webp" alt><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.wrapper &#123;</span><br><span class="line">  display: grid;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>如上图所示，默认为块级元素，独占一行。<br><img src="/images/grid/grid_3.webp" alt><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.wrapper &#123;</span><br><span class="line">  display: inline-grid;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>如上图所示，也可设为行内块元素，与其他元素并排。</p>
<h3 id="grid-template-设置网格区域"><a href="#grid-template-设置网格区域" class="headerlink" title="grid-template 设置网格区域"></a><code>grid-template</code> 设置网格区域</h3><p>设置每一列宽：<code>grid-template-columns: &lt;track-size&gt; ... | &lt;line-name&gt; &lt;track-size&gt; ...;</code><br>设置每一行高：<code>grid-template-rows: &lt;track-size&gt; ... | &lt;line-name&gt; &lt;track-size&gt; ...;</code><br>设置网格布局允许指定区域：<code>grid-template-areas:  &quot;&lt;grid-area-name&gt; | . | none | ...&quot;
    &quot;...&quot;;</code><br> <strong><track-size></track-size></strong> - can be a length, a percentage, or a fraction of the free space in the grid (using the <code>[fr](https://css-tricks.com/snippets/css/complete-guide-grid/#fr-unit)</code> unit)<br><strong><line-name></line-name></strong> - an arbitrary name of your choosing<br><strong><grid-area-name></grid-area-name></strong> - the name of a grid area specified with `[grid-area]</p>
<p><img src="/images/grid/grid_4.webp" alt><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">.wrapper &#123;</span><br><span class="line">  display: grid;</span><br><span class="line">  grid-template-columns: 50px 50px 50px;</span><br><span class="line">  grid-template-rows: 50px 50px 50px;</span><br><span class="line">  /* grid-template-columns: 33.33% 33.33% 33.33%;</span><br><span class="line">  grid-template-rows: 33.33% 33.33% 33.33%; */</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>如上图所示，设置每一列为50px，每一行为50px，也可设为33.33%，等价的。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">.wrapper &#123;</span><br><span class="line">  display: grid;</span><br><span class="line">  grid-template-columns: repeat(3, 50px);</span><br><span class="line">  grid-template-rows: repeat(3, 50px);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>也可使用<code>repeat</code>属性值，第一个为参数为重复的次数，第二个参数为重复的值。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">.wrapper &#123;</span><br><span class="line">  display: grid;</span><br><span class="line">  /* grid-template-columns: 1fr 1fr 1fr;</span><br><span class="line">  grid-template-rows: 1fr 1fr 1fr; */</span><br><span class="line">  grid-template-columns: repeat(3, 1fr);</span><br><span class="line">  grid-template-rows: repeat(3, 1fr);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>也可使用<code>fr</code>属性值(fraction,每一分块区域)，如果两列的宽度分别为<code>1fr</code>和<code>3fr</code>，就表示后者是前者的三倍。</p>
<p><img src="/images/grid/grid_5.webp" alt><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">.wrapper &#123;</span><br><span class="line">  display: grid;</span><br><span class="line">  grid-template-columns: 50px 2fr 1fr;</span><br><span class="line">  grid-template-rows: repeat(3, 1fr);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>如上图所示，我们经常会结合<code>px</code>和<code>fr</code>一起用，第一列<code>50px</code>,剩下两列分三份分<code>100px</code>，第二列站<code>2份</code>，第三列站<code>1份</code>，因此上面列宽依次为<code>50px 66.66px 33.33px</code>。</p>
<p><img src="/images/grid/grid_6.webp" alt></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">.wrapper &#123;</span><br><span class="line">  display: grid;</span><br><span class="line">  grid-template-columns: 50px minmax(40px, 100px) 20px;</span><br><span class="line">  grid-template-rows: repeat(3, 1fr);</span><br><span class="line">  /* grid-template-columns: 50px minmax(40px, 100px) minmax(20px, 40px);</span><br><span class="line">  grid-template-rows: repeat(3, 1fr); */</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如上图所示，可设置<code>minmax</code>属性值来设置大小，中间这一列最小值为40px，最大值为100px，因此上面列宽依次为<code>50px 80px 20px</code>。</p>
<p><img src="/images/grid/grid_7.webp" alt></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">.wrapper &#123;</span><br><span class="line">   display: grid;</span><br><span class="line">   grid-template-columns: 50px minmax(40px, 100px) minmax(20px, 40px);     </span><br><span class="line">   grid-template-rows: repeat(3, 1fr);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如上图所示，列宽依次是50px 60px 40px,是怎样计算呢？<br><a href="https://bitsofco.de/how-the-minmax-function-works/" target="_blank" rel="noopener">how-the-minmax-function-works</a><br><img src="/images/grid/grid_8.webp" alt><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">.wrapper &#123;</span><br><span class="line">   display: grid;</span><br><span class="line">   grid-template-columns: 20px auto auto;</span><br><span class="line">   grid-template-rows: repeat(3, 1fr);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>如上图所示，可设置<code>auto</code>属性值，让浏览器绝对长度，因此上面列宽依次为<code>20px 65px 65px</code>。</p>
<p><img src="/images/grid/grid_9.webp" alt></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">.grid-template-areas &#123;</span><br><span class="line">  display: grid;</span><br><span class="line">  grid-template-columns: 50px 50px 50px 50px;</span><br><span class="line">  grid-template-rows: auto;</span><br><span class="line">  grid-template-areas:</span><br><span class="line">    &apos;header header header header&apos;</span><br><span class="line">    &apos;main main . sidebar&apos;</span><br><span class="line">    &apos;footer footer footer footer&apos;;</span><br><span class="line">&#125;</span><br><span class="line">.item-1 &#123;</span><br><span class="line">  grid-area: header;</span><br><span class="line">&#125;</span><br><span class="line">.item-2 &#123;</span><br><span class="line">  grid-area: main;</span><br><span class="line">&#125;</span><br><span class="line">.item-3 &#123;</span><br><span class="line">  grid-area: sidebar;</span><br><span class="line">&#125;</span><br><span class="line">.item-4 &#123;</span><br><span class="line">  grid-area: footer;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如上图所示，<code>grid-template-areas</code>设置<code>4x3</code>网格， <code>grid-area</code>对应所选区域，<code>.</code>代表不填充，留空白。</p>
<h3 id="grid-gap设置行与行间距、列与列间距"><a href="#grid-gap设置行与行间距、列与列间距" class="headerlink" title="grid-gap设置行与行间距、列与列间距"></a><code>grid-gap</code>设置行与行间距、列与列间距</h3><p><code>grid-gap: &lt;grid-row-gap&gt; &lt;grid-column-gap&gt;;</code><br><img src="/images/grid/grid_10.webp" alt></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">.container &#123;</span><br><span class="line">  display: grid;</span><br><span class="line">  grid-template-columns: 100px 50px 100px;</span><br><span class="line">  grid-template-rows: 80px auto 80px;</span><br><span class="line">  grid-gap: 15px 10px;</span><br><span class="line">  /* grid-row-gap: 15px;</span><br><span class="line">  grid-column-gap: 10px; */</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如上图所示，设置行间距为<code>15px</code>，列间距为<code>10px</code></p>
<ol>
<li><code>grid-auto-flow</code> 设置排列方式，默认“先行后列”<br><code>grid-auto-flow: row | column | row dense | column dense</code></li>
</ol>
<p><img src="/images/grid/grid_11.webp" alt></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">.wrapper &#123;</span><br><span class="line">  display: grid;</span><br><span class="line">  grid-template-columns: repeat(3, 1fr);</span><br><span class="line">  grid-template-rows: repeat(3, 1fr);</span><br><span class="line">&#125;</span><br><span class="line">.item-1 &#123;</span><br><span class="line">  /* 代表所占列的网格线为1～3，grid-row 不写默认为所占行的网格线为1～2 */</span><br><span class="line">  grid-column: 1 / 3; </span><br><span class="line">&#125;</span><br><span class="line">.item-2 &#123;</span><br><span class="line">  grid-column: 1 / 3;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如上图所示，为默认排列，先行后列，放不下就放到下一行。</p>
<p><img src="/images/grid/grid_12.webp" alt></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">.wrapper &#123;</span><br><span class="line">  display: grid;</span><br><span class="line">  grid-template-columns: repeat(3, 1fr);</span><br><span class="line">  grid-template-rows: repeat(3, 1fr);</span><br><span class="line">  grid-auto-flow: row dense;</span><br><span class="line">&#125;</span><br><span class="line">.item-1 &#123;</span><br><span class="line">  /* 代表所占列的网格线1～3，grid-row 不写默认为所占行的网格线1～2 */</span><br><span class="line">  grid-column: 1 / 3;</span><br><span class="line">&#125;</span><br><span class="line">.item-2 &#123;</span><br><span class="line">  grid-column: 1 / 3;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上图所排为默认排列，先行后列，并且紧凑，尽量不留空隙。</p>
<h3 id="place-items-设置网格内容的位置"><a href="#place-items-设置网格内容的位置" class="headerlink" title="place-items 设置网格内容的位置"></a><code>place-items</code> 设置网格内容的位置</h3><p><code>place-items: &lt;align-items&gt; &lt;justify-items&gt;;</code> <strong>先竖直后水平</strong><br>水平位置：<code>justify-items: start | end | center | stretch;</code><br>竖直位置：<code>align-items: start | end | center | stretch;</code></p>
<ul>
<li>start：对齐网格的起始边缘</li>
<li>end：对齐网格的结束边缘</li>
<li>center：网格内部居中</li>
<li>stretch：拉伸，占满网格的整个宽度（默认值）。</li>
</ul>
<p><img src="/images/grid/grid_13.webp" alt></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">.wrapper &#123;</span><br><span class="line">  display: grid;</span><br><span class="line">  grid-template-columns: repeat(3, 50px);</span><br><span class="line">  grid-template-rows: repeat(3, 50px);</span><br><span class="line">  place-items: start end;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如上图所示，竖直位置内容从上到下排列，水平位置内容从左到右排列。</p>
<p><img src="/images/grid/grid_14.webp" alt></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">.wrapper &#123;</span><br><span class="line">  display: grid;</span><br><span class="line">  grid-template-columns: repeat(3, 50px);</span><br><span class="line">  grid-template-rows: repeat(3, 50px);</span><br><span class="line">  place-items: start stretch;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如上图所示，竖直位置内容从上到下排列，水平位置拉伸占满网格的整个宽度。</p>
<h3 id="place-content设置整个内容区域在容器里面的位置"><a href="#place-content设置整个内容区域在容器里面的位置" class="headerlink" title="place-content设置整个内容区域在容器里面的位置"></a><code>place-content</code>设置整个内容区域在容器里面的位置</h3><p><code>place-content: &lt;align-content&gt; &lt;justify-content&gt;</code><br> 水平位置：<code>justify-content: start | end | center | stretch | space-around | space-between | space-evenly;</code><br>垂直位置： <code>align-content:start | end | center | stretch | space-around | space-between | space-evenly;</code></p>
<ul>
<li>start: 将网格对齐以与容器的起始边缘齐平</li>
<li>end: 将网格对齐以与容器的末端边缘齐平</li>
<li>stretch: 调整网格的大小填充容器的整个宽度(默认值)</li>
<li>space-around: 每个网格两侧的间隔相等，两端到容器的间隔是网格的一半</li>
<li>space-between: 网格与网格的间隔相等，网格与容器边框之间没有间隔</li>
<li>space-evenly: 每个网格之间间距相同，包括到两端距离</li>
</ul>
<p><img src="/images/grid/grid_15.webp" alt><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">.wrapper &#123;</span><br><span class="line">  box-shadow: 0px 0px 2px 1px #cccccc;</span><br><span class="line">  width: 250px;</span><br><span class="line">  height: 250px;</span><br><span class="line">  display: grid;</span><br><span class="line">  grid-template-columns: repeat(3, 50px);</span><br><span class="line">  grid-template-rows: repeat(3, 50px);</span><br><span class="line">  place-content: end end;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>如上图所示，整个内容区在容器的水平方向末端，竖直方向末端。</p>
<p><img src="/images/grid/grid_16.webp" alt><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">.wrapper &#123;</span><br><span class="line">  box-shadow: 0px 0px 2px 1px #cccccc;</span><br><span class="line">  width: 250px;</span><br><span class="line">  height: 250px;</span><br><span class="line">  display: grid;</span><br><span class="line">  grid-template-columns: repeat(3, 50px);</span><br><span class="line">  grid-template-rows: repeat(3, 50px);</span><br><span class="line">  place-content: space-evenly space-evenly;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>如上图所示， 每个网格之间间距相同，包括到两端距离。</p>
<h3 id="grid-auto-rows-grid-auto-column设置超出定义网格的网格大小"><a href="#grid-auto-rows-grid-auto-column设置超出定义网格的网格大小" class="headerlink" title="grid-auto-rows grid-auto-column设置超出定义网格的网格大小"></a><code>grid-auto-rows grid-auto-column</code>设置超出定义网格的网格大小</h3><p><img src="/images/grid/grid_17.webp" alt></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">.wrapper &#123;</span><br><span class="line">  box-shadow: 0px 0px 2px 1px #cccccc;</span><br><span class="line">  width: 250px;</span><br><span class="line">  height: 250px;</span><br><span class="line">  box-sizing: border-box;</span><br><span class="line">  display: grid;</span><br><span class="line">  grid-template-columns: repeat(3, 50px);</span><br><span class="line">  grid-template-rows: repeat(3, 50px);</span><br><span class="line">  grid-auto-rows: 80px;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如上图所示，定义一个3x3网格，第10个网格超出区域，超出行的高度为80px。</p>
<h3 id="grid-row-grid-column设置网格自身起始、终止线"><a href="#grid-row-grid-column设置网格自身起始、终止线" class="headerlink" title="grid-row grid-column设置网格自身起始、终止线"></a><code>grid-row grid-column</code>设置网格自身起始、终止线</h3><p><code>grid-column: grid-column-start / grid-column-end</code><br><code>grid-row: grid-row-start / grid-row-end</code><br><code>grid-column: &lt;start-line&gt; / &lt;end-line&gt; | &lt;start-line&gt; / span &lt;value&gt;</code><br> <code>grid-row: &lt;start-line&gt; / &lt;end-line&gt; | &lt;start-line&gt; / span &lt;value&gt;</code></p>
<p><img src="/images/grid/grid_18.webp" alt></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">.wrapper &#123;</span><br><span class="line">  box-shadow: 0px 0px 2px 1px #cccccc;</span><br><span class="line">  width: 250px;</span><br><span class="line">  height: 250px;</span><br><span class="line">  box-sizing: border-box;</span><br><span class="line">  display: grid;</span><br><span class="line">  grid-template-columns: repeat(3, 50px);</span><br><span class="line">  grid-template-rows: repeat(4, 50px);</span><br><span class="line">&#125;</span><br><span class="line">.item-1 &#123;</span><br><span class="line">  /* 简写 */</span><br><span class="line">  grid-row: 2 / 4;</span><br><span class="line">  grid-column: 2 / 4;</span><br><span class="line">  /* 拆开写相同*/</span><br><span class="line">  /* grid-row-start: 2;</span><br><span class="line">  grid-row-end: 4;</span><br><span class="line">  grid-column-start: 2;</span><br><span class="line">  grid-column-end: 4; */</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如上图所示，定义一个3x3网格，第一个网格水平方向起始线为2，终止线为4，竖直方向起始线为2，终止线为4，剩下的网格会按默认依次排列。</p>
<h3 id="place-self-设置单元网格内容位置。"><a href="#place-self-设置单元网格内容位置。" class="headerlink" title="place-self 设置单元网格内容位置。"></a><code>place-self</code> 设置单元网格内容位置。</h3><p><code>place-self: &lt;align-self&gt; &lt;justify-self&gt;;</code><br><code>justify-self: start | end | center | stretch;</code><br><code>align-self: start | end | center | stretch;</code><br><img src="/images/grid/grid_19.webp" alt><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">.wrapper &#123;</span><br><span class="line">  display: grid;</span><br><span class="line">  grid-template-columns: repeat(3, 50px);</span><br><span class="line">  grid-template-rows: repeat(3, 30px);</span><br><span class="line">&#125;</span><br><span class="line">.item-1 &#123;</span><br><span class="line">  place-self: center center;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>如上图所示，<code>item-1</code>在第一个网格上下左右中间位置。</p>
<h2 id="示例相关代码"><a href="#示例相关代码" class="headerlink" title="示例相关代码"></a>示例相关代码</h2><p><a href="https://github.com/Xiamer/css-example/tree/master/grid" target="_blank" rel="noopener">https://github.com/Xiamer/css-example/tree/master/grid</a></p>
<h2 id="grid-兼容性"><a href="#grid-兼容性" class="headerlink" title="grid 兼容性"></a>grid 兼容性</h2><p><img src="/images/grid/grid_20.webp" alt><br><a href="https://caniuse.com/#search=css%20grid" target="_blank" rel="noopener">https://caniuse.com/#search=css%20grid</a></p>
<h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><ul>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/CSS_Grid_Layout" target="_blank" rel="noopener">https://developer.mozilla.org/zh-CN/docs/Web/CSS/CSS_Grid_Layout</a></li>
<li><a href="https://css-tricks.com/snippets/css/complete-guide-grid/#prop-grid-template-areas" target="_blank" rel="noopener">https://css-tricks.com/snippets/css/complete-guide-grid/#prop-grid-template-areas</a></li>
<li><a href="http://www.ruanyifeng.com/blog/2019/03/grid-layout-tutorial.html" target="_blank" rel="noopener">http://www.ruanyifeng.com/blog/2019/03/grid-layout-tutorial.html</a></li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  


          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <div class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Xiamer</p>
              <div class="site-description motion-element" itemprop="description">Xiamer blog</div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">6</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                      <a href="/categories/">
                    
                  
                    
                    
                      
                    
                    <span class="site-state-item-count">1</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                      <a href="/tags/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">3</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://github.com/xiamer" title="GitHub &rarr; https://github.com/xiamer" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="mailto:xiamer.chou@gmail.com" title="E-Mail &rarr; mailto:xiamer.chou@gmail.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                </span>
              
            </div>
          

          

          
          

          
            
          
          

        </div>
      </div>

      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Xiamer</span>

  

  
</div>


  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v3.8.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> v7.1.0</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/utils.js?v=7.1.0"></script>

  <script src="/js/motion.js?v=7.1.0"></script>



  
  


  <script src="/js/affix.js?v=7.1.0"></script>

  <script src="/js/schemes/pisces.js?v=7.1.0"></script>



  

  


  <script src="/js/next-boot.js?v=7.1.0"></script>


  

  

  

  



  




  

  

  

  

  

  

  

  

  

  

  

  

  

  

</body>
</html>
